function InitSelect2(){void 0!=jQuery.fn.select2&&(jQuery("span.select2").remove(),jQuery("select").each(function(){var e=jQuery(this).data("select2");void 0!=e&&jQuery(this).select2("destroy"),jQuery(this).select2()}))}function showNotifySuccess(e){jQuery.notify({message:e},{type:"success"})}function showNotifyDanger(e){jQuery.notify({message:e},{type:"danger"})}function RemoveFromDomWithAnimation(e){jQuery(e).fadeTo("fast",.005,function(){jQuery(this).slideUp("fast",function(){jQuery(this).remove()})})}function DoAjax(e,t){var a=e.prop("nodeName").toUpperCase(),n=!1,r=!1,o=e;"A"==a?r=!0:"FORM"==a&&(n=!0);var i=o.attr("method");if("undefined"==typeof i&&(i=o.data("method"),"undefined"==typeof i&&(i="GET")),i=i.toUpperCase(),n){if(formaction=o.attr("action"),"undefined"==typeof formaction&&(formaction=window.location.href),parameters=o.serializeArray(),form_data=parameters,link=formaction,"GET"==i&&(link=formaction.split("?"),link=link[0],parameters.length>0)){link+="?";for(var u=0;u<parameters.length;u++)link+=parameters[u].name+"="+parameters[u].value,u!=parameters.length-1&&(link+="&")}}else link=o.attr("href");if("#"==link)return t.preventDefault(),!1;var d=o.data("ajax-target");"undefined"==typeof d&&(d="ajax_target_div"),"yes"==o.data("removecontent")&&jQuery("#"+d).html("").trigger("htmlchanged");var l=o.data("modal")||!1,s=o.data("showloadingoverlay")||"";if(s="no"==s||l?!1:!0,l&&jQuery("#"+d).empty(),loading_overlay=d+"_loading_overlay",0==jQuery("#"+d).length)return!0;if(jQuery("#"+loading_overlay).length||jQuery("#"+d).append('<div class="loading_overlay'+(0==s?" loading_overlay_transparent":"")+'" id="'+loading_overlay+'"><div><i class="fa fa-refresh fa-spin"></i></div></div>'),d="#"+d,loading_overlay="#"+loading_overlay,changeurl=o.data("changebrowserlink"),"undefined"==typeof changeurl||"no"!=changeurl?changeurl=!0:changeurl=!1,"undefined"!=typeof t&&t.preventDefault(),textBeforeChange=!1,ajaxoptions={url:link,method:i,timeout:45e3,beforeSend:function(e){if(modalID=jQuery(this).data("modal"),modalID&&jQuery("#"+modalID).empty(),jQuery(loading_overlay).show(),parentheight=jQuery(loading_overlay).parent().height(),overlayheight=jQuery(loading_overlay).height(),winheight=jQuery(window).height(),winoffset=jQuery(window).scrollTop(),parentoffset=jQuery(loading_overlay).parent().offset().top,loading_element=jQuery(loading_overlay).find("div"),overlayheight-20>parentheight&&jQuery(loading_overlay).parent().css({"min-height":overlayheight}),jQuery(loading_overlay).parent().height()>winheight&&loading_element.css({bottom:"auto",top:winoffset+winheight/2-parentoffset-loading_element.height()/2}),changeurl&&currenturl!=link&&(window.history.pushState("Page","Link changed",link),currenturl=link),n){var t=o.children().find("button[type=submit]");1==t.length&&(textBeforeChange=t.html(),t.html(ComponentStorage.texts.buttonLoading).trigger("htmlchanged"))}else r&&o.hasClass("btn")&&(textBeforeChange=o.html(),o.html(ComponentStorage.texts.buttonLoading).trigger("htmlchanged"))}},n){var c=jQuery("button[type=submit][clicked=true]");if(1==c.length){var y=(jQuery(c).html(),jQuery(c).data("loading-text"));void 0!=y&&c.html(y).trigger("htmlchanged"),jQuery(c).attr("clicked",!1)}}if(n&&"POST"==i&&(ajaxoptions.data=form_data,"undefined"!=typeof c)){var h=jQuery(c).attr("name")||"buttonNoName";"undefined"!=h&&ajaxoptions.data.push({name:h,value:!0})}var f=o.data("ajax-success")||!1,g=o.data("ajax-error")||!1;return jQuery.ajax(ajaxoptions).done(function(e,t,a){0==e.indexOf('<script data-type="refresh"')?jQuery(d).append(e):(jQuery(d).html(e).trigger("htmlchanged"),jQuery(loading_overlay).hide()),"undefined"!=typeof jQuery(d+" input[type=radio]").screwDefaultButtons,f&&window[f](o,e,a)}).fail(function(e,t,a){if(jQuery(loading_overlay).hide(),"timeout"==e.statusText&&jQuery("#modal_error .modal-body #modal-error-title").html(ComponentStorage.texts.timeoutText).trigger("htmlchanged"),jQuery("#modal_error .modal-body").html(e.responseText).trigger("htmlchanged"),0!=textBeforeChange)if(n){var i=o.children().find("button[type=submit]");1==i.length&&i.html(textBeforeChange).trigger("htmlchanged")}else r&&o.hasClass("btn")&&o.html(textBeforeChange).trigger("htmlchanged");g&&window[g](o,jqXHR)}).always(function(e){}),!1}function DoAjaxInline(e,t,a){var e=jQuery(e),n=e.attr("href"),r=e.data("text-success")||ComponentStorage.texts.row_edit_ok,o=e.data("text-error")||ComponentStorage.texts.row_edit_error,i=e.data("ajax-success")||!1,u=e.data("ajax-error")||!1,d=e.data("ajax-method")||"GET";a=a||{};var l={method:d,url:n,data:a};jQuery.ajax(l).done(function(t,a,n){t.Success?(showNotifySuccess(r),i&&window[i](e,t,n)):(showNotifyDanger(o),u&&window[u](e,n))}).fail(function(t,a,n){showNotifyDanger(o),u&&window[u](e,t)})}function HandleModalHeight(){var e=jQuery(".modal");e.each(function(){e=jQuery(this);var t=jQuery(".modal-dialog",e),a=jQuery(".modal-header",e),n=jQuery(".modal-body",e),r=jQuery(".modal-footer",e),o=t.offset(),i=65;o&&(i=2*o.top+5),i+=a.outerHeight(),i+=r.outerHeight(),n.css({"max-height":jQuery(window.top).height()-i})})}function format_filesize(e){var t,a=["B","kB","MB","GB","TB"];return e=Math.max(e,0),t=Math.floor((e?Math.log(e):0)/Math.log(1024)),t=Math.min(t,a.length-1),e/=Math.pow(1024,t),Math.round(e)+" "+a[t]}jQuery(document).ready(function(){function e(){jQuery('[title!=""]').tooltip({placement:"top"}),void 0!=jQuery.fn.select2&&jQuery("select:not(#share_input_select):not(.filter)").select2(),jQuery(".dropdown-toggle").dropdown(),void 0!=window.HandleLeftMenu&&HandleLeftMenu(),void 0!=jQuery.fn.daterangepicker&&(jQuery(".daterangepickerinput").daterangepicker(jQuery.extend(ComponentStorage.daterangepicker,{singleDatePicker:!1,showDropdowns:!1}),function(e,t,a){}).on("cancel.daterangepicker",function(e,t){jQuery(this).val("")}).on("apply.daterangepicker",function(e,t){jQuery(this).val(t.startDate.format(ComponentStorage.daterangepicker.locale.format)+ComponentStorage.daterangepicker.locale.separator+t.endDate.format(ComponentStorage.daterangepicker.locale.format))}),jQuery(".daterangepickersingleinput").daterangepicker(jQuery.extend(ComponentStorage.daterangepicker,{singleDatePicker:!0,showDropdowns:!0}),function(e,t,a){}).on("cancel.daterangepicker",function(e,t){jQuery(this).val("")}).on("apply.daterangepicker",function(e,t){jQuery(this).val(t.startDate.format(ComponentStorage.daterangepicker.locale.format))})),"undefined"!=typeof StorageTables,void 0!=jQuery.fn.DataTable&&jQuery("table").not(".table-mysql").each(function(){var e=jQuery(this);if(!jQuery.fn.DataTable.isDataTable(e)){var t={aLengthMenu:[30,50,100,500],oLanguage:ComponentStorage.oLanguage,oPaginate:ComponentStorage.oPaginate,responsive:!0,processing:e.data("processing")||!1,serverSide:e.data("serverside")||!1,ajax:e.data("ajax")||"",aaSorting:[],dom:'<"top"flp<"clear">>rt<"bottom"ip<"clear">>',fnRowCallback:function(t,a,n){if("table_elements"==e.attr("id")){var r=a.quantity_number,o=a.quantity_warning_number;0==r?jQuery(t).addClass("danger"):o>r&&jQuery(t).addClass("warning")}return t}},a=new Array;jQuery("thead tr th",e).each(function(){var e=jQuery(this).data("column")||!1,t=jQuery(this).data("class")||!1,n={};e&&(n.data=e),t&&(n.className=t),a.push(n)}),a.length>0&&(t.columns=a);e.data("urlparams");void 0!=e.data("urlparams")&&(t.fnServerParams=function(t){var a=e.data("urlparams");for(k in a)t[k]=a[k]}),StorageTables=e.DataTable(t)}})}jQuery("body").on("dblclick",".inline_edit",function(){var e=jQuery(this);e.removeClass("inline_edit"),e.find(".inline_edit_icon").remove();var t=e.html(),a=e.data("id"),n=e.data("what"),r=e.data("inputtype")||"text";r=r.toLowerCase();var o=e.data("url-func"),i=e.data("success-func")||!1,u=e.data("error-func")||!1,d=e.data("options-func"),l=e.attr("data-options-selected")||0;"undefined"==typeof r&&(r="text");var s;if("textarea"==r)s=jQuery("<textarea></textarea>").html(t).trigger("htmlchanged");else if("select"==r){var c=[];c=window[d](n),s=jQuery("<select></select>").data("select-options",c);var y="";for(k in c)y="",k==l&&(y=' selected="selected"'),s.append('<option value="'+k+'"'+y+">"+c[k]+"</option>")}else s=jQuery("<input />").attr("type",r).val(t);s.attr("data-url-func",o).attr("data-what",n).attr("data-id",a).attr("data-value",t).attr("data-success-func",i).attr("data-error-func",u).addClass("inline_input").addClass("form-control").addClass("width-100"),e.html(s).trigger("htmlchanged"),e.children().focus()}),jQuery("body").on("focusout",".inline_input",function(){t(jQuery(this),jQuery(this).parent())}),jQuery("body").on("keyup","input.inline_input, textarea.inline_input",function(e){13==e.keyCode&&t(jQuery(this),jQuery(this).parent())}),jQuery(window).resize(function(){HandleModalHeight()}),jQuery(".modal").on("htmlchanged",function(){}),jQuery("body").on("mouseover mouseout",".inline_edit",function(e){"mouseover"==e.type?0==jQuery(this).find(".inline_input").length&&jQuery(this).append('<i class="fa inline_edit_icon fa-pencil-square-o pull-right"></i>'):jQuery(this).find(".inline_edit_icon").remove()});var t=function(e,t){var a=(e.data("id"),e.val()),n=e.data("value"),r=e.data("what"),o=e.data("url-func"),i=e.data("success-func")||!1,u=e.data("error-func")||!1,d=window[o](e);d+="?:what=:value".replace(":what",r).replace(":value",a);var l=e.data("select-options")||!1,s=a;l&&(a=l[a]),jQuery(this).parent().find(".inline_edit_icon").remove(),jQuery.ajax({method:"POST",url:d}).done(function(o){o.Success?(t.attr("data-options-selected",s),t.html(a).trigger("htmlchanged"),showNotifySuccess(ComponentStorage.texts.row_edit_ok),i&&window[i](e,r,s)):(e.parent().html(n).trigger("htmlchanged"),showNotifyDanger(ComponentStorage.texts.row_edit_error),u&&window[u](e,r,s))}).fail(function(t,a,o){e.parent().html(n).trigger("htmlchanged"),showNotifyDanger(ComponentStorage.texts.row_edit_error),u&&window[u](e,r,s)}).always(function(){t.addClass("inline_edit")})};HandleModalHeight(),jQuery(".dropdown-toggle").dropdown(),jQuery('[title!=""]').tooltip(),jQuery("body").on("click",".storage-alert .close",function(e){jQuery(this).parent().parent().fadeTo("slow",.005,function(){jQuery(this).slideUp()})}),jQuery("body").on("click","a.ajax_inline",function(e){DoAjaxInline(jQuery(this),e,{})}),jQuery("body").on("click","a.element_quantity_set",function(e){e.preventDefault(),thisElement=jQuery(this);var t=jQuery(this).data("element"),a=jQuery("#element_quantity_"+t),n=jQuery(this).data("text-success")||ComponentStorage.texts.row_edit_ok,r=jQuery(this).data("text-error")||ComponentStorage.texts.row_edit_error;jQuery.ajax({url:jQuery(this).attr("href"),method:"GET"}).done(function(e){"ERROR"!=e?(a.html(e).trigger("htmlchanged"),showNotifySuccess(n)):showNotifyDanger(r)}).fail(function(e,t,a){showNotifyDanger(r)})}),InitSelect2(),jQuery("body").on("click",".select-all",function(e){e.preventDefault();var t=jQuery(this).data("select")||!1;return t?(t="#"+t,jQuery(t+" > option").prop("selected","selected"),void jQuery(t).trigger("change")):!0}),jQuery("body").on("click",".select-none",function(e){e.preventDefault();var t=jQuery(this).data("select")||!1;return t?(t="#"+t,jQuery(t+" > option").removeAttr("selected"),void jQuery(t).trigger("change")):!0}),jQuery("body").on("click","a[data-confirm]",function(e){return e=jQuery(this),jQuery("#modal_confirm a.button_confirm").attr("href",e.attr("href")),jQuery("#modal_confirm .modal-body").html(e.data("confirm")).trigger("htmlchanged"),jQuery("#modal_confirm").modal({keyboard:!0}),!1}),jQuery("body").on("click","a.delete",function(e){if(!e.isDefaultPrevented()){var e=jQuery(this);e.children().addClass("fa-spin"),jQuery.ajax({url:e.attr("href"),method:"GET"}).done(function(t){e.parents("tr").fadeOut("slow",function(){StorageTables.row(e.parents("tr")).remove().draw()}),showNotifySuccess(ComponentStorage.texts.row_delete_ok)}).fail(function(e,t,a){showNotifyDanger(ComponentStorage.texts.row_delete_error)})}}),jQuery("body").on("click","form [type=submit]",function(){jQuery("[type=submit]",jQuery(this).parents("form")).removeAttr("clicked"),jQuery(this).attr("clicked","true")}),jQuery("body").on("click",".pagination li a, a.ajax",function(e){DoAjax(jQuery(this),e)}),jQuery("body").on("submit","form.ajax",function(e){DoAjax(jQuery(this),e)}),ajaxStartFunction=function(){jQuery("#ajax_loading").show()},ajaxCompleteFunction=function(){jQuery("#ajax_loading").hide(),e(),HandleModalHeight()},jQuery(document).ajaxStart(ajaxStartFunction),jQuery(document).ajaxComplete(ajaxCompleteFunction),jQuery(document).on("click","[data-modal]",function(){modalID=jQuery(this).data("modal"),jQuery("#"+modalID).modal("show")}),jQuery(document).on("click",".flash-message",function(){jQuery(this).fadeTo("slow",.005,function(){jQuery(this).slideUp()})}),jQuery("body").on("click","button, .btn",function(e){var t=jQuery(this).data("submit-form")||!1;return t?(e.preventDefault(),jQuery("#"+t).submit(),!1):void 0}),setInterval(function(){jQuery(".event_datetime").each(function(){var e=jQuery(this).data("datetime")||!1;return e?void 0:!1})},1e3),e()}),currenturl=window.location.href,window.setTimeout(function(){window.addEventListener("popstate",function(){window.location.reload()})},1e3);